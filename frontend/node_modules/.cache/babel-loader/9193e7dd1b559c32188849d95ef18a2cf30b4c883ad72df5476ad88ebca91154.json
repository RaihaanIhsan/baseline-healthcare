{"ast":null,"code":"const express = require('express');\nconst jwt = require('jsonwebtoken');\nconst router = express.Router();\nconst {\n  findUserByUsername\n} = require('../models/user');\n\n// Secret key for JWT (in production, use environment variable)\nconst JWT_SECRET = 'baseline-healthcare-secret-key-2024';\nconst JWT_EXPIRATION = '24h';\n\n// Simple login - WITH JWT TOKEN\nrouter.post('/login', (req, res) => {\n  const startTime = Date.now(); // Start timing\n\n  const {\n    username,\n    password\n  } = req.body;\n  if (!username || !password) {\n    return res.status(400).json({\n      error: 'Username and password required',\n      responseTime: Date.now() - startTime\n    });\n  }\n  const user = findUserByUsername(username);\n  if (!user) {\n    return res.status(401).json({\n      error: 'Invalid credentials',\n      responseTime: Date.now() - startTime\n    });\n  }\n\n  // Plain text password comparison - NO SECURITY (baseline)\n  if (user.password !== password) {\n    return res.status(401).json({\n      error: 'Invalid credentials',\n      responseTime: Date.now() - startTime\n    });\n  }\n\n  // Generate JWT token\n  const token = jwt.sign({\n    id: user.id,\n    username: user.username,\n    role: user.role,\n    department: user.department\n  }, JWT_SECRET, {\n    expiresIn: JWT_EXPIRATION\n  });\n  const responseTime = Date.now() - startTime;\n\n  // Return user info and token\n  res.json({\n    message: 'Login successful',\n    token: token,\n    user: {\n      id: user.id,\n      username: user.username,\n      role: user.role,\n      department: user.department\n    },\n    responseTime: responseTime,\n    timestamp: new Date().toISOString()\n  });\n});\n\n// Token verification endpoint (optional - for testing)\nrouter.post('/verify', (req, res) => {\n  var _req$headers$authoriz;\n  const startTime = Date.now();\n  const token = (_req$headers$authoriz = req.headers.authorization) === null || _req$headers$authoriz === void 0 ? void 0 : _req$headers$authoriz.replace('Bearer ', '');\n  if (!token) {\n    return res.status(401).json({\n      error: 'No token provided',\n      responseTime: Date.now() - startTime\n    });\n  }\n  try {\n    const decoded = jwt.verify(token, JWT_SECRET);\n    res.json({\n      valid: true,\n      user: decoded,\n      responseTime: Date.now() - startTime,\n      timestamp: new Date().toISOString()\n    });\n  } catch (error) {\n    res.status(401).json({\n      valid: false,\n      error: 'Invalid token',\n      responseTime: Date.now() - startTime\n    });\n  }\n});\n\n// Simple logout\nrouter.post('/logout', (req, res) => {\n  const startTime = Date.now();\n  res.json({\n    message: 'Logout successful',\n    responseTime: Date.now() - startTime,\n    timestamp: new Date().toISOString()\n  });\n});\nmodule.exports = router;","map":{"version":3,"names":["express","require","jwt","router","Router","findUserByUsername","JWT_SECRET","JWT_EXPIRATION","post","req","res","startTime","Date","now","username","password","body","status","json","error","responseTime","user","token","sign","id","role","department","expiresIn","message","timestamp","toISOString","_req$headers$authoriz","headers","authorization","replace","decoded","verify","valid","module","exports"],"sources":["D:/Semester 7/NIS/cep/layerzero/frontend/src/services/auth.js"],"sourcesContent":["const express = require('express');\r\nconst jwt = require('jsonwebtoken');\r\nconst router = express.Router();\r\nconst { findUserByUsername } = require('../models/user');\r\n\r\n// Secret key for JWT (in production, use environment variable)\r\nconst JWT_SECRET = 'baseline-healthcare-secret-key-2024';\r\nconst JWT_EXPIRATION = '24h';\r\n\r\n// Simple login - WITH JWT TOKEN\r\nrouter.post('/login', (req, res) => {\r\n  const startTime = Date.now(); // Start timing\r\n  \r\n  const { username, password } = req.body;\r\n  \r\n  if (!username || !password) {\r\n    return res.status(400).json({ \r\n      error: 'Username and password required',\r\n      responseTime: Date.now() - startTime \r\n    });\r\n  }\r\n\r\n  const user = findUserByUsername(username);\r\n  \r\n  if (!user) {\r\n    return res.status(401).json({ \r\n      error: 'Invalid credentials',\r\n      responseTime: Date.now() - startTime \r\n    });\r\n  }\r\n\r\n  // Plain text password comparison - NO SECURITY (baseline)\r\n  if (user.password !== password) {\r\n    return res.status(401).json({ \r\n      error: 'Invalid credentials',\r\n      responseTime: Date.now() - startTime \r\n    });\r\n  }\r\n\r\n  // Generate JWT token\r\n  const token = jwt.sign(\r\n    {\r\n      id: user.id,\r\n      username: user.username,\r\n      role: user.role,\r\n      department: user.department\r\n    },\r\n    JWT_SECRET,\r\n    { expiresIn: JWT_EXPIRATION }\r\n  );\r\n\r\n  const responseTime = Date.now() - startTime;\r\n\r\n  // Return user info and token\r\n  res.json({\r\n    message: 'Login successful',\r\n    token: token,\r\n    user: {\r\n      id: user.id,\r\n      username: user.username,\r\n      role: user.role,\r\n      department: user.department\r\n    },\r\n    responseTime: responseTime,\r\n    timestamp: new Date().toISOString()\r\n  });\r\n});\r\n\r\n// Token verification endpoint (optional - for testing)\r\nrouter.post('/verify', (req, res) => {\r\n  const startTime = Date.now();\r\n  const token = req.headers.authorization?.replace('Bearer ', '');\r\n\r\n  if (!token) {\r\n    return res.status(401).json({ \r\n      error: 'No token provided',\r\n      responseTime: Date.now() - startTime \r\n    });\r\n  }\r\n\r\n  try {\r\n    const decoded = jwt.verify(token, JWT_SECRET);\r\n    res.json({\r\n      valid: true,\r\n      user: decoded,\r\n      responseTime: Date.now() - startTime,\r\n      timestamp: new Date().toISOString()\r\n    });\r\n  } catch (error) {\r\n    res.status(401).json({\r\n      valid: false,\r\n      error: 'Invalid token',\r\n      responseTime: Date.now() - startTime\r\n    });\r\n  }\r\n});\r\n\r\n// Simple logout\r\nrouter.post('/logout', (req, res) => {\r\n  const startTime = Date.now();\r\n  res.json({ \r\n    message: 'Logout successful',\r\n    responseTime: Date.now() - startTime,\r\n    timestamp: new Date().toISOString()\r\n  });\r\n});\r\n\r\nmodule.exports = router;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}